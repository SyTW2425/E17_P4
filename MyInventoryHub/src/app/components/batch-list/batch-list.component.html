<!-- Selector para elegir el campo de búsqueda -->
<label for="searchCriteria">Buscar por:</label>
<select id="searchCriteria" [(ngModel)]="searchCriteria">
  <option value="id">ID</option>
  <option value="productId">ID Producto</option>
  <option value="batchNumber">Número de Lote</option>
  <option value="quantity">Cantidad</option>
  <option value="expirationDate">Fecha de Expiración</option>
  <option value="receivedDate">Fecha de Recepción</option>
</select>

<!-- Campo de búsqueda -->
<input
  type="text"
  [(ngModel)]="searchTerm"
  (input)="filterBatches()"
  placeholder="Buscar..."
/>

<!-- Botón para mostrar el formulario de adición -->
<div>
  <button (click)="startAddBatch()">Añadir Lote</button>
</div>

<!-- Formulario para añadir un nuevo lote, visible solo si isAdding es true -->
<div *ngIf="isAdding">
  <h3>Añadir Nuevo Lote</h3>
  <form (ngSubmit)="addBatch()">
    <label>ID:</label>
    <input type="number" [(ngModel)]="newBatch.id" name="newBatchId" required />

    <label>ID Producto:</label>
    <input type="number" [(ngModel)]="newBatch.productId" name="newBatchProductId" required />

    <label>Número de Lote:</label>
    <input type="text" [(ngModel)]="newBatch.batchNumber" name="newBatchNumber" required />

    <label>Cantidad:</label>
    <input type="number" [(ngModel)]="newBatch.quantity" name="newBatchQuantity" required />

    <label>Fecha de Expiración:</label>
    <input type="date" [(ngModel)]="newBatch.expirationDate" name="newBatchExpirationDate" required />

    <label>Fecha de Recepción:</label>
    <input type="date" [(ngModel)]="newBatch.receivedDate" name="newBatchReceivedDate" required />

    <button type="submit">Guardar Lote</button>
    <button type="button" (click)="cancelAdd()">Cancelar</button>
  </form>
</div>

<!-- Tabla de lotes -->
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>ID Producto</th>
      <th>Número de Lote</th>
      <th>Cantidad</th>
      <th>Fecha de Expiración</th>
      <th>Fecha de Recepción</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let batch of filteredBatches">
      <td>{{ batch.id }}</td>
      <td>{{ batch.productId }}</td>
      <td>{{ batch.batchNumber }}</td>
      <td>{{ batch.quantity }}</td>
      <td>{{ batch.expirationDate | date }}</td>
      <td>{{ batch.receivedDate | date }}</td>
      <td>
        <button (click)="editBatch(batch)">Editar</button>
        <button (click)="deleteBatch(batch.id)">Eliminar</button>
      </td>
    </tr>
  </tbody>
</table>

<!-- Formulario de edición (visible solo cuando isEditing es true) -->
<div *ngIf="isEditing" class="edit-form">
  <h3>Editar Lote</h3>
  <form (ngSubmit)="saveBatch()">
    <label for="batchNumber">Número de Lote</label>
    <input
      type="text"
      id="batchNumber"
      [(ngModel)]="selectedBatch!.batchNumber"
      name="batchNumber"
      required
    />

    <label for="productId">ID Producto</label>
    <input
      type="number"
      id="productId"
      [(ngModel)]="selectedBatch!.productId"
      name="productId"
      required
    />

    <label for="quantity">Cantidad</label>
    <input
      type="number"
      id="quantity"
      [(ngModel)]="selectedBatch!.quantity"
      name="quantity"
      required
    />

    <label for="expirationDate">Fecha de Expiración</label>
    <input
      type="date"
      id="expirationDate"
      [(ngModel)]="selectedBatch!.expirationDate"
      name="expirationDate"
      required
    />

    <label for="receivedDate">Fecha de Recepción</label>
    <input
      type="date"
      id="receivedDate"
      [(ngModel)]="selectedBatch!.receivedDate"
      name="receivedDate"
      required
    />

    <button type="submit">Guardar</button>
    <button type="button" (click)="cancelEdit()">Cancelar</button>
  </form>
</div>
